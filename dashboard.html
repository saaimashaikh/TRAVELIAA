<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Travelia | Dashboard</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
@import url('https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;600;700;800&display=swap');

:root {
  --primary: #f0426e;
  --bg-light: #f8f6f6;
  --bg-dark: #221015;
  --white: #ffffff;
  --text-dark: #181113;
  --text-soft: #89616b;
}

/* RESET */
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
  font-family: 'Plus Jakarta Sans', sans-serif;
}

/* BODY */
body {
  background: linear-gradient(135deg, #f8f6f6, #ffe9ef);
  color: var(--text-dark);
  min-height: 100vh;
}

/* NAVBAR */
.navbar {
  background: rgba(255, 255, 255, 0.95);
  backdrop-filter: blur(10px);
  padding: 18px 40px;
  display: flex;
  justify-content: space-between;
  align-items: center;
  box-shadow: 0 10px 30px rgba(240, 66, 110, 0.08);
  border-bottom: 1px solid #f0426e15;
}

.logo {
  color: var(--primary);
  font-weight: 800;
  font-size: 1.6rem;
}

.navbar ul {
  list-style: none;
  display: flex;
  gap: 25px;
}

.navbar a {
  text-decoration: none;
  color: var(--text-dark);
  font-weight: 600;
  transition: 0.3s;
}

.navbar a:hover {
  color: var(--primary);
}

/* DASHBOARD GRID */
.dashboard {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
  gap: 30px;
  padding: 50px;
}

/* PANELS (Glass Style Like Login) */
.panel {
  background: rgba(255, 255, 255, 0.95);
  backdrop-filter: blur(12px);
  padding: 28px;
  border-radius: 20px;
  box-shadow: 0 15px 40px rgba(240, 66, 110, 0.08);
  border: 1px solid #f0426e15;
  transition: 0.3s ease;
}

.panel:hover {
  transform: translateY(-6px);
  box-shadow: 0 20px 50px rgba(240, 66, 110, 0.15);
}

.panel h2 {
  margin-bottom: 18px;
  color: var(--primary);
  font-weight: 800;
}

/* INPUTS */
input, select {
  width: 100%;
  padding: 12px;
  margin: 8px 0;
  border-radius: 12px;
  border: 1px solid #e6dbde;
  outline: none;
  transition: 0.3s;
  font-weight: 500;
}

input:focus, select:focus {
  border-color: var(--primary);
  box-shadow: 0 0 0 3px rgba(240, 66, 110, 0.15);
}

/* BUTTONS */
button {
  width: 100%;
  padding: 13px;
  margin-top: 12px;
  border-radius: 30px;
  border: none;
  background: linear-gradient(135deg, #f0426e, #ff7a9a);
  color: white;
  font-weight: 700;
  cursor: pointer;
  transition: 0.3s ease;
  box-shadow: 0 8px 20px rgba(240, 66, 110, 0.2);
}

button:hover {
  transform: translateY(-2px);
  box-shadow: 0 12px 25px rgba(240, 66, 110, 0.3);
}

/* LISTS */
ul {
  padding-left: 20px;
}

li {
  margin-bottom: 12px;
  color: var(--text-soft);
  font-weight: 500;
}

/* DATE & RESULT TEXT */
.date-preview,
#convertedResult,
#budgetResult {
  margin-top: 12px;
  font-weight: 600;
  color: var(--text-soft);
}
</style>
<link
  rel="stylesheet"
  href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
/>
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script>
const WEATHER_API_KEY = "d68b5ee9c0366f64d7bf5e48d0ab4761";

let map;
let marker;

async function searchLocation() {
  const place = document.getElementById("locationInput").value;
  if (!place) {
    alert("Enter a location");
    return;
  }

  document.getElementById("result").innerHTML = "Loading...";

  try {
    const res = await fetch(
      `https://api.openweathermap.org/data/2.5/weather?q=${place}&units=metric&appid=${WEATHER_API_KEY}`
    );
    const data = await res.json();

    if (data.cod !== 200) {
      document.getElementById("result").innerHTML = "Location not found";
      return;
    }

    const lat = data.coord.lat;
    const lon = data.coord.lon;

    document.getElementById("result").innerHTML = `
      <h3>${data.name}</h3>
      <p>üå§Ô∏è Weather: ${data.main.temp}¬∞C, ${data.weather[0].description}</p>
    `;

    showMap(lat, lon, data.name);

  } catch (error) {
    document.getElementById("result").innerHTML = "Error fetching data";
  }
}

function showMap(lat, lon, city) {
  if (!map) {
    map = L.map("map").setView([lat, lon], 12);

    L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", {
      attribution: "¬© OpenStreetMap"
    }).addTo(map);

    marker = L.marker([lat, lon]).addTo(map)
      .bindPopup(city)
      .openPopup();
  } else {
    map.setView([lat, lon], 12);
    marker.setLatLng([lat, lon])
      .setPopupContent(city)
      .openPopup();
  }
}
</script>

</head>
<body>

<!-- NAVBAR -->
<nav class="navbar">
  <h1 class="logo">Travelia</h1>
  <ul>
    <li><a href="suggest.html">AI Suggestion</a></li>
     <li><a href="reviews.html">Reviews</a></li>
     <li><a href="collaborate.html">Collaborate</a></li>
    <li><a href="#" onclick="logout()"> Logout‚èª </a></li>
  </ul>
</nav>



<!-- DASHBOARD -->
<section class="dashboard">

  <!-- CREATE TRIP -->
  <div class="panel">
    <h2>Create Trip</h2>
    <input id="destination" type="text" placeholder="Destination">
    <input id="budget" type="number" placeholder="Budget in INR (‚Çπ)">
    <label>Start Date</label>
    <input type="date" id="startDate">
    <label>End Date</label>
    <input type="date" id="endDate">
    <p id="datePreview" class="date-preview">Select travel dates</p>
    <button onclick="addTrip()">Add Trip</button>
  </div>

  <!-- PLANNED TRIPS -->
  <div class="panel">
    <h2>Planned Trips</h2>
    <ul id="tripList"></ul>
  </div>

  <!-- CURRENCY CONVERTER -->
  <div class="panel">
    <h2>Global Currency Converter</h2>
    <input id="inrAmount" type="number" placeholder="Amount in INR (‚Çπ)">
    <select id="currencySelect">
      <option>Loading currencies...</option>
    </select>
    <button onclick="convertCurrency()">Convert</button>
    <p id="convertedResult" class="date-preview"></p>
  </div>

 

  <div class="panel">
  <h2>Budget Breakdown</h2>

  <input type="number" id="totalBudget" placeholder="Total Budget (‚Çπ)">
  <input type="number" id="transport" placeholder="Transport (‚Çπ)">
  <input type="number" id="stay" placeholder="Stay (‚Çπ)">
  <input type="number" id="food" placeholder="Food (‚Çπ)">
  <input type="number" id="activities" placeholder="Activities (‚Çπ)">

  <button onclick="calculateBudget()">Calculate</button>

  <p id="budgetResult" class="date-preview"></p>


</div>

<!-- üåç Explore Location Panel -->
<div class="panel">
  <h2>üìç Search Location</h2>

  <input type="text" id="locationInput" placeholder="Enter place name">
  <button onclick="searchLocation()">Search</button>

  <div id="result" style="margin-top:20px;"></div>

  <div id="map" style="height:300px; margin-top:20px; border-radius:15px;"></div>
</div>


</section>

<SCRIPT>

  // --- Trips ---
  let trips = [];
  function addTrip() {
    const dest = document.getElementById("destination").value;
    const bud = document.getElementById("budget").value;
    const start = document.getElementById("startDate").value;
    const end = document.getElementById("endDate").value;

    if (!dest || !bud || !start || !end) {
      alert("Please fill all trip details");
      return;
    }

    trips.push({ destination: dest, budget: bud, startDate: start, endDate: end });

    document.getElementById("destination").value = "";
    document.getElementById("budget").value = "";
    document.getElementById("startDate").value = "";
    document.getElementById("endDate").value = "";
    document.getElementById("datePreview").textContent = "Select travel dates";

    renderTrips();
  }

  function renderTrips() {
    const tripList = document.getElementById("tripList");
    tripList.innerHTML = "";
    trips.forEach(t => {
      const li = document.createElement("li");
      li.innerHTML = `<strong>${t.destination}</strong><br>
                      Budget: ‚Çπ${t.budget}<br>
                      Dates: ${t.startDate} ‚Üí ${t.endDate}`;
      tripList.appendChild(li);
    });
  }

  // --- Date Preview ---
  document.getElementById("startDate").addEventListener("change", updateDatePreview);
  document.getElementById("endDate").addEventListener("change", updateDatePreview);

  function updateDatePreview() {
    const start = document.getElementById("startDate").value;
    const end = document.getElementById("endDate").value;
    const preview = document.getElementById("datePreview");

    if (start && end) {
      preview.textContent = `Trip planned from ${start} to ${end}`;
    }
  }

  
  // --- Currency Details ---
  const currencyDetails = {
    USD: { country: "United States of America", symbol: "$" },
    EUR: { country: "Eurozone Countries", symbol: "‚Ç¨" },
    GBP: { country: "United Kingdom", symbol: "¬£" },
    JPY: { country: "Japan", symbol: "¬•" },
    INR: { country: "India", symbol: "‚Çπ" },
    AUD: { country: "Australia", symbol: "A$" },
    CAD: { country: "Canada", symbol: "C$" },
    CHF: { country: "Switzerland", symbol: "CHF" },
    CNY: { country: "China", symbol: "¬•" },
    AED: { country: "United Arab Emirates", symbol: "ÿØ.ÿ•" },
    SAR: { country: "Saudi Arabia", symbol: "Ô∑º" },
    ZAR: { country: "South Africa", symbol: "R" },
    RUB: { country: "Russia", symbol: "‚ÇΩ" },
    KRW: { country: "South Korea", symbol: "‚Ç©" },
    SGD: { country: "Singapore", symbol: "S$" },
    NZD: { country: "New Zealand", symbol: "NZ$" },
    THB: { country: "Thailand", symbol: "‡∏ø" },
    MYR: { country: "Malaysia", symbol: "RM" },
    IDR: { country: "Indonesia", symbol: "Rp" },
    PHP: { country: "Philippines", symbol: "‚Ç±" },
    TRY: { country: "Turkey", symbol: "‚Ç∫" },
    BRL: { country: "Brazil", symbol: "R$" },
    MXN: { country: "Mexico", symbol: "$" },
    PLN: { country: "Poland", symbol: "z≈Ç" },
    SEK: { country: "Sweden", symbol: "kr" },
    NOK: { country: "Norway", symbol: "kr" },
    DKK: { country: "Denmark", symbol: "kr" },
    HUF: { country: "Hungary", symbol: "Ft" },
    CZK: { country: "Czech Republic", symbol: "Kƒç" },
    ILS: { country: "Israel", symbol: "‚Ç™" },
    PKR: { country: "Pakistan", symbol: "‚Ç®" },
    BDT: { country: "Bangladesh", symbol: "‡ß≥" },
    LKR: { country: "Sri Lanka", symbol: "Rs" },
    NPR: { country: "Nepal", symbol: "‚Ç®" }
  };

  // --- Currency Converter ---
  let exchangeRates = {};
  async function loadCurrencies() {
    const res = await fetch("https://api.exchangerate-api.com/v4/latest/INR");
    const data = await res.json();
    exchangeRates = data.rates;

    const select = document.getElementById("currencySelect");
    select.innerHTML = "";

    Object.keys(currencyDetails).forEach(code => {
      const option = document.createElement("option");
      option.value = code;
      option.textContent = `${code} (${currencyDetails[code].country})`;
      select.appendChild(option);
    });
  }

  function convertCurrency() {
    const inr = parseFloat(document.getElementById("inrAmount").value);
    const currency = document.getElementById("currencySelect").value;

    if (!inr || !currency) {
      alert("Enter amount and select currency");
      return;
    }

    const rate = exchangeRates[currency];
    const converted = (inr * rate).toFixed(2);
    const symbol = currencyDetails[currency].symbol || currency;

    document.getElementById("convertedResult").textContent =
      `Converted Amount: ${symbol}${converted}`;
  }

  loadCurrencies();

  function calculateBudget() {
  const total = Number(totalBudget.value);
  const spent =
    Number(transport.value) +
    Number(stay.value) +
    Number(food.value) +
    Number(activities.value);

  const remaining = total - spent;
  const result = document.getElementById("budgetResult");

  if (remaining < 0) {
    result.style.color = "red";
    result.textContent = `Over Budget by ‚Çπ${Math.abs(remaining)}`;
  } else {
    result.style.color = "green";
    result.textContent = `Remaining Budget: ‚Çπ${remaining}`;
  }
}

function saveTrip(place) {
  const user = firebase.auth().currentUser;

  if (!user) {
    alert("Please login first");
    return;
  }

  db.collection("users")
    .doc(user.uid)
    .collection("trips")
    .add({
      place: place,
      createdAt: firebase.firestore.FieldValue.serverTimestamp()
    })
    .then(() => {
      loadTrips();
    })
    .catch(err => {
      console.error(err);
      alert("Error saving trip");
    });
}
function loadTrips() {
  const user = firebase.auth().currentUser;
  if (!user) return;

  const tripList = document.getElementById("tripList");
  tripList.innerHTML = "";

  db.collection("users")
    .doc(user.uid)
    .collection("trips")
    .orderBy("createdAt", "desc")
    .get()
    .then(snapshot => {
      snapshot.forEach(doc => {
        const li = document.createElement("li");
        li.textContent = doc.data().place;
        tripList.appendChild(li);
      });
    });
}
firebase.auth().onAuthStateChanged(user => {
  if (user) {
    loadTrips();
  }
});

</script>

<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>

<script>

  const firebaseConfig = {
    apiKey: "AIzaSyBLYgFIujF0ALn9MFvwNxygX8fauq6KMDw",
    authDomain: "travelia-e185f.firebaseapp.com",
    projectId: "travelia-e185f"
  };


  if (!firebase.apps.length) {
    firebase.initializeApp(firebaseConfig);
  }

  const auth = firebase.auth();

  // LOGOUT FUNCTION
  function logout() {
    auth.signOut()
      .then(() => {
        window.location.href = "index.html";
      })
      .catch(error => {
        alert("Logout failed: " + error.message);
      });
  }


  auth.onAuthStateChanged(user => {
    if (!user) {
      window.location.href = "index.html";
    }
  });



</script>

</body>
</html>
